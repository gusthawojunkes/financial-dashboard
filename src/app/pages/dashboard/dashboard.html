<div *ngIf="transactions.length > 0; else noData" class="dashboard-grid">
    <!-- Summary Cards -->
    <div class="summary-cards">
        <div class="card summary-card">
            <div class="summary-icon revenue-icon">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="16" cy="16" r="14" stroke="#4CAF50" stroke-width="2" fill="#E8F5E9"/>
                    <text x="16" y="22" text-anchor="middle" font-size="18" font-family="Arial, Helvetica, sans-serif"
                          fill="#388E3C" font-weight="bold">$
                    </text>
                </svg>
            </div>
            <div>
                <p class="summary-title">Receitas</p>
                <p class="summary-value">{{ summary.revenue | currency:'BRL' }}</p>
            </div>
        </div>
        <div class="card summary-card">
            <div class="summary-icon expenses-icon">
                <svg fill="none" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"></path>
                </svg>
            </div>
            <div>
                <p class="summary-title">Despesas</p>
                <p class="summary-value">{{ summary.expenses | currency:'BRL' }}</p>
            </div>
        </div>
        <div class="card summary-card">
            <div class="summary-icon balance-icon">
                <svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="6" y="14" width="36" height="20" rx="4" fill="#FFF8E1" stroke="#FFB300" stroke-width="4"/>
                    <rect x="30" y="20" width="8" height="8" rx="2" fill="#FFECB3" stroke="#FFB300" stroke-width="2"/>
                    <path d="M6 18V14a4 4 0 0 1 4-4h28a4 4 0 0 1 4 4v4" stroke="#FFB300" stroke-width="2"/>
                </svg>
            </div>
            <div>
                <p class="summary-title">Saldo</p>
                <p class="summary-value" [class.positive]="summary.balance >= 0" [class.negative]="summary.balance < 0">
                    {{ summary.balance | currency:'BRL' }}
                </p>
            </div>
        </div>
    </div>

    <!-- Chart -->
    <div class="card">
        <div class="chart-header">
            <h2 class="chart-title">{{ chartTitle }}</h2>
            <button *ngIf="isDetailView" (click)="createCategoryChart()" class="back-button">&larr; Voltar para
                Categorias
            </button>
        </div>
        <div class="chart-container">
            <canvas #mainChart id="main-chart"></canvas>
        </div>
    </div>

    <!-- Transactions Table -->
    <div class="card">
        <h2 class="table-title">Detalhes das Transações</h2>
        <div class="table-wrapper">
            <table>
                <thead>
                <tr>
                    <th>Descrição</th>
                    <th>Data</th>
                    <th>Categoria</th>
                    <th class="text-right">Valor</th>
                </tr>
                </thead>
                <tbody>
                <!-- Modificado para usar paginatedTransactions -->
                <tr *ngFor="let tx of paginatedTransactions" [class.revenue-row]="tx.value > 0"
                    [class.expense-row]="tx.value < 0">
                    <td>{{ tx.description }}</td>
                    <td>{{ tx.transactionTime }}</td>
                    <td><span class="category-tag">{{ tx.category }}</span></td>
                    <td class="text-right" [class.positive]="tx.value > 0" [class.negative]="tx.value < 0">
                        {{ tx.value | currency:'BRL' }}
                    </td>
                </tr>
                <!-- Mensagem se não houver transações na página atual, mas houver transações no geral -->
                <tr *ngIf="transactions && transactions.length > 0 && (!paginatedTransactions || paginatedTransactions.length === 0)">
                    <td colspan="4" style="text-align: center;">Nenhuma transação para exibir nesta página.</td>
                </tr>
                </tbody>
            </table>
        </div>

        <!-- Controles de Paginação -->
        <div class="pagination-controls" *ngIf="transactions && transactions.length > 0 && totalPages > 1">
            <div class="items-per-page-selector">
                <label for="itemsPerPageSelect">Itens por página: </label>
                <select id="itemsPerPageSelect" [ngModel]="itemsPerPage" (ngModelChange)="onItemsPerPageChange($event)">
                    <option *ngFor="let option of itemsPerPageOptions" [value]="option">{{ option }}</option>
                </select>
            </div>
            <div class="page-navigation">
                <button (click)="goToPage(currentPage - 1)" [disabled]="currentPage === 1" class="pagination-button">
                    &laquo; Anterior
                </button>
                <span>Página {{ currentPage }} de {{ totalPages }}</span>
                <button (click)="goToPage(currentPage + 1)" [disabled]="currentPage === totalPages"
                        class="pagination-button">
                    Próxima &raquo;
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Template para quando não há dados -->
<ng-template #noData>
    <div class="card no-data-container">
        <h2>Nenhum dado para exibir</h2>
        <p>Por favor, vá para a página de <strong>Importar</strong> para carregar um ficheiro financeiro.</p>
    </div>
</ng-template>

